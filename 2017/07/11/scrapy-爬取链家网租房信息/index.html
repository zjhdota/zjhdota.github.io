<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">

<head>
  <meta charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <title>scrapy 爬取链家网租房信息 | Nameless</title>
  <meta name="description" content="If you want something you've never had, then you've got to do something you've never done." />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="本文主要记录学习使用scrapy来获取链家网中北京地区的租房信息，并将获取到的信息存储到MySQL数据库的过程。  本机主要运行环境 Arch Linux scrapy MySQL Python3.6  安装scrapy为了方便安装,以及解决依赖问题,我们选择用pip安装scrapy.1# pip install Scrapy 附上scrapy 中文使用手册便于使用 初步了解scrapyscrap">
<meta name="keywords" content="MySQL,Python,爬虫,scrapy,链家网">
<meta property="og:type" content="article">
<meta property="og:title" content="scrapy 爬取链家网租房信息">
<meta property="og:url" content="http://yoursite.com/2017/07/11/scrapy-爬取链家网租房信息/index.html">
<meta property="og:site_name" content="Nameless">
<meta property="og:description" content="本文主要记录学习使用scrapy来获取链家网中北京地区的租房信息，并将获取到的信息存储到MySQL数据库的过程。  本机主要运行环境 Arch Linux scrapy MySQL Python3.6  安装scrapy为了方便安装,以及解决依赖问题,我们选择用pip安装scrapy.1# pip install Scrapy 附上scrapy 中文使用手册便于使用 初步了解scrapyscrap">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/images/scrapy2.png">
<meta property="og:image" content="http://yoursite.com/images/scrapy3.png">
<meta property="og:updated_time" content="2018-02-18T03:02:16.484Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="scrapy 爬取链家网租房信息">
<meta name="twitter:description" content="本文主要记录学习使用scrapy来获取链家网中北京地区的租房信息，并将获取到的信息存储到MySQL数据库的过程。  本机主要运行环境 Arch Linux scrapy MySQL Python3.6  安装scrapy为了方便安装,以及解决依赖问题,我们选择用pip安装scrapy.1# pip install Scrapy 附上scrapy 中文使用手册便于使用 初步了解scrapyscrap">
<meta name="twitter:image" content="http://yoursite.com/images/scrapy2.png">
  <!-- build:css css/screen.css -->

  <link rel="stylesheet" href="/css/screen.css">
  
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  
  <!-- endbuild -->
  
  <!-- build:css fancybox/jquery.fancybox.css -->
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <!-- endbuild -->
  
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
  <meta name="generator" content="Nameless">
  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  
</head>


<body class="post-template">

  <header class="main-header post-head no-cover" >
    <nav class="main-nav  clearfix">
        
        <a class="back-button icon-arrow-left" href="/">Home</a>
        <a class="subscribe-button icon-feed" href="/atom.xml">Subscribe</a>
    </nav>
    
    <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
</header>

  

<main id="content" class="content" role="main">
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
      <h1 class="post-title" itemprop="name">scrapy 爬取链家网租房信息</h1>
      <section class="post-meta">
  <time datetime="2017-07-11T00:43:08.000Z" itemprop="datePublished" class="post-date">
      2017-07-11
  </time>
  
  
  on 
  <a href='/tags/MySQL/'>MySQL</a>,
  
  <a href='/tags/Python/'>Python</a>,
  
  <a href='/tags/爬虫/'>爬虫</a>,
  
  <a href='/tags/scrapy/'>scrapy</a>,
  
  <a href='/tags/链家网/'>链家网</a>
  
  
</section>

    </header>
    <section class="post-content" itemprop="description articleBody">
      

      
      <section class="post-updated">
  Last updated on <time datetime="2018-02-18T03:02:16.484Z" itemprop="dateModified">
      2018-02-18
  </time>
</section>

      
      <p>本文主要记录学习使用scrapy来获取链家网中北京地区的租房信息，并将获取到的信息存储到MySQL数据库的过程。</p>
<hr>
<h4 id="本机主要运行环境"><a href="#本机主要运行环境" class="headerlink" title="本机主要运行环境"></a>本机主要运行环境</h4><ul>
<li>Arch Linux</li>
<li>scrapy</li>
<li>MySQL</li>
<li>Python3.6</li>
</ul>
<h4 id="安装scrapy"><a href="#安装scrapy" class="headerlink" title="安装scrapy"></a>安装scrapy</h4><p>为了方便安装,以及解决依赖问题,我们选择用pip安装scrapy.<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> pip install Scrapy</span></span><br></pre></td></tr></table></figure></p>
<p>附上<a href="http://scrapy-chs.readthedocs.io/zh_CN/0.24/intro/tutorial.html" target="_blank" rel="noopener">scrapy 中文使用手册</a>便于使用</p>
<h4 id="初步了解scrapy"><a href="#初步了解scrapy" class="headerlink" title="初步了解scrapy"></a>初步了解scrapy</h4><p>scrapy 目录结构:<br><img src="/images/scrapy2.png" alt=""></p>
<p>文件简要说明:</p>
<ul>
<li>scrapy.cfg: 项目的配置文件,用于配置项目名称、URL等属性</li>
<li>LianjiaSpider/: 该项目的python模块。</li>
<li>LianjiaSpider/items.py: 项目中的item文件.保存爬取到的数据</li>
<li>LianjiaSpider/pipelines.py: 项目中的pipelines文件，将item保存的数据进行处理</li>
<li>LianjiaSpider/settings.py: 项目的设置文件.用于配置爬虫的属性</li>
<li>LianjiaSpider/middlewares.py 项目中间件的配置。例，配置ip池或者UA池</li>
<li>LianjiaSpider/spiders/: 放置爬虫代码的目录.</li>
</ul>
<h4 id="编写爬虫"><a href="#编写爬虫" class="headerlink" title="编写爬虫"></a>编写爬虫</h4><p>先创建个scrapy工程,命令行输入<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> scrapy startproject LianjiaSpider</span></span><br></pre></td></tr></table></figure></p>
<p>我们在spiders目录下,新建个爬虫文件叫LianjiaSpider.py<br>在这个爬虫文件中，爬虫必须继承scrapy.Spider这个爬虫类<br>此外还必须定义如下三个属性</p>
<ol>
<li>name:定义爬虫名字</li>
<li>star_urls:用于存储待爬取的URL列表</li>
<li>parse():用于解析URL完成下载后Respoense对象,以及生成下一个待处理的URL的Request对象</li>
</ol>
<p>废话不多说，直接上代码<br>LianjiaSpider.py<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line">import scrapy</span><br><span class="line"><span class="built_in">from</span> ..<span class="keyword">items</span> import LianjiaspiderItem</span><br><span class="line"></span><br><span class="line">class LianjiaSpider(scrapy.spiders.Spider):</span><br><span class="line">    name = <span class="string">'LianjiaSpider'</span> <span class="comment"># 爬虫名称</span></span><br><span class="line">    start_urls = [] <span class="comment"># 存储爬虫URL</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">        start_urls.append(<span class="string">'https://bj.lianjia.com/zufang/pg'</span>+str(i)) <span class="comment"># 存储链家网北京租房信息前100页的URL</span></span><br><span class="line">    allowed_domains = [<span class="string">"linajia.com"</span>]</span><br><span class="line"></span><br><span class="line">    def parse(self, response):</span><br><span class="line">        <span class="keyword">item</span> = LianjiaspiderItem() <span class="comment"># 定义item类的对象用于储存数据</span></span><br><span class="line">        title_list = response.xpath(<span class="string">"//li[@data-el='zufang']/div[2]/h2/a/text()"</span>).extract() <span class="comment"># 获取所有获取租房标题</span></span><br><span class="line">        location_list = response.xpath(<span class="string">"//li[@data-el='zufang']/div[2]/div[1]/div[1]/a/span/text()"</span>).extract() <span class="comment"># 获取所有房子地理位置</span></span><br><span class="line">        zone_list = response.xpath(<span class="string">"//li[@data-el='zufang']/div[2]/div[1]/div[1]/span[1]/span/text()"</span>).extract() <span class="comment"># 获取所有房子厅室信息</span></span><br><span class="line">        meters_list = response.xpath(<span class="string">"//li[@data-el='zufang']/div[2]/div[1]/div[1]/span[2]/text()"</span>).extract() <span class="comment"># 获取所有房子的平米</span></span><br><span class="line">        direction_list = response.xpath(<span class="string">"//li[@data-el='zufang']/div[2]/div[1]/div[1]/span[3]/text()"</span>).extract() <span class="comment"># 获取所有房子朝向</span></span><br><span class="line">        money_list = response.xpath(<span class="string">"//li[@data-el='zufang']/div[2]/div[2]/div[1]/span/text()"</span>).extract() <span class="comment"># 获取所有房子的月租</span></span><br><span class="line">        <span class="keyword">for</span> i, j, k, l, m, n <span class="keyword">in</span> zip(title_list, location_list, zone_list, meters_list, direction_list, money_list): <span class="comment"># 将每种信息组合在一起,并传给一个item</span></span><br><span class="line">            <span class="keyword">item</span>[<span class="string">'title'</span>] = i</span><br><span class="line">            <span class="keyword">item</span>[<span class="string">'location'</span>] = j</span><br><span class="line">            <span class="keyword">item</span>[<span class="string">'zone'</span>] = k</span><br><span class="line">            <span class="keyword">item</span>[<span class="string">'meters'</span>] = l</span><br><span class="line">            <span class="keyword">item</span>[<span class="string">'direction'</span>] = m</span><br><span class="line">            <span class="keyword">item</span>[<span class="string">'money'</span>] = n</span><br><span class="line">            yield <span class="keyword">item</span></span><br></pre></td></tr></table></figure></p>
<p>item.py<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define here the models for your scraped items</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># See documentation in:</span></span><br><span class="line"><span class="comment"># http://doc.scrapy.org/en/latest/topics/items.html</span></span><br><span class="line"></span><br><span class="line">import <span class="keyword">scrapy</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">class </span>LianjiaspiderItem(<span class="keyword">scrapy.Item):</span></span><br><span class="line"><span class="keyword"> </span>   <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    <span class="comment"># name = scrapy.Field()</span></span><br><span class="line">    title = <span class="keyword">scrapy.Field() </span><span class="comment"># 用于存储房子标题</span></span><br><span class="line">    location = <span class="keyword">scrapy.Field() </span><span class="comment"># 用于存储地理位置信息</span></span><br><span class="line">    zone = <span class="keyword">scrapy.Field() </span><span class="comment"># 用户存储房子的厅室信息</span></span><br><span class="line">    meters = <span class="keyword">scrapy.Field() </span><span class="comment"># 用于存储房子的平米信息</span></span><br><span class="line">    <span class="keyword">direction </span>= <span class="keyword">scrapy.Field() </span><span class="comment"># 用于存储房子的朝向信息</span></span><br><span class="line">    money = <span class="keyword">scrapy.Field() </span><span class="comment"># 用于存储房子的月租信息</span></span><br></pre></td></tr></table></figure></p>
<p>pipelines.py<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define your item pipelines here</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span></span><br><span class="line"><span class="comment"># See: http://doc.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line">import MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LianjiaspiderPipeline</span>(<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">open_spider</span><span class="params">(<span class="keyword">self</span>, spider)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.con = MySQLdb.connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'密码'</span>, <span class="string">'数据库名字'</span>)</span><br><span class="line">        <span class="keyword">self</span>.cursor = <span class="keyword">self</span>.con.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(<span class="keyword">self</span>, item, spider)</span></span><span class="symbol">:</span></span><br><span class="line">        insert_sql = <span class="string">"INSERT INTO lianjia(TITLE, LOCATION, ZONE, METERS, DIRECTION, MONEY) VALUES ('&#123;&#125;', '&#123;&#125;', '&#123;&#125;', '&#123;&#125;', '&#123;&#125;', '&#123;&#125;')"</span>.format(item[<span class="string">'title'</span>], item[<span class="string">'location'</span>], item[<span class="string">'zone'</span>], item[<span class="string">'meters'</span>], item[<span class="string">'direction'</span>], item[<span class="string">'money'</span>])</span><br><span class="line">        <span class="keyword">self</span>.cursor.execute(insert_sql) <span class="comment"># 执行sql语句</span></span><br><span class="line">        <span class="keyword">self</span>.con.commit() <span class="comment"># 提交到数据库，insert和updata语句必须执行这句</span></span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">spider_close</span><span class="params">(<span class="keyword">self</span>, spider)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.con.close()</span><br></pre></td></tr></table></figure></p>
<p>在项目配置文件settings.py中添加如下代码<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">   'LianjiaSpider.pipelines.LianjiaspiderPipeline': 300,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意：<br>因为scrapy爬虫在请求URL的时候会遵循robots.txt中的协议，恰恰链家网中robots.txt是禁止爬虫爬取根目录的，所以我们要在项目配置文件settings.py中配置<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ROBOTSTXT_OBEY</span> = <span class="literal">False</span></span><br></pre></td></tr></table></figure></p>
<h4 id="优化爬虫"><a href="#优化爬虫" class="headerlink" title="优化爬虫"></a>优化爬虫</h4><p>为了使我们的爬虫能够顺利的进行，并且尽量使目标网站不会封禁我们的IP，我们需要如下几种方法去配置爬虫</p>
<ol>
<li><p>禁用cookie,在项目配置文件settings.py中添加</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">COOKIES_ENABLED</span> = <span class="literal">False</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置爬取延迟,在项目配置文件settings.py中添加</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">DOWNLOAD_DELAY</span> = <span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置user_agent池,随机分配user__agent<br> 这里我没用middlewares.py来编写中间件，而是在settings.py的同级目录中新建个中间件useragent_middleware.py，代码如下:</p>
 <figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="title">from</span> scrapy.downloadermiddlewares.useragent <span class="keyword">import</span> UserAgentMiddleware</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">RotateUserAgentMiddleware</span>(<span class="type">UserAgentMiddleware</span>):</span></span><br><span class="line"><span class="class">	def __init__(<span class="title">self</span>, <span class="title">user_agent</span>=''):</span></span><br><span class="line"><span class="class">	    self.user_agent = user_agent</span></span><br><span class="line"><span class="class">	def process_request(<span class="title">self</span>, <span class="title">request</span>, <span class="title">spider</span>):</span></span><br><span class="line"><span class="class">	    ua = random.choice(<span class="title">self</span>.<span class="title">user_agent_list</span>)</span></span><br><span class="line"><span class="class">	    if ua:</span></span><br><span class="line"><span class="class">	        request.headers.setdefault('<span class="type">User</span>-<span class="type">Agent</span>', <span class="title">ua</span>)</span></span><br><span class="line"><span class="class">	#the default user_agent_list composes chrome,<span class="type">IE</span>,firefox,<span class="type">Mozilla</span>,opera,netscape</span></span><br><span class="line"><span class="class">	#for more user agent strings,you can find it in http://www.useragentstring.com/pages/useragentstring.php</span></span><br><span class="line"><span class="class">	user_agent_list = [</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.3.6; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Nexus</span> <span class="type">S</span> <span class="type">Build</span>/<span class="type">GRK39F</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Avant</span> <span class="type">Browser</span>/1.2.789rel1 (<span class="title">http</span>://<span class="title">www</span>.<span class="title">avantbrowser</span>.<span class="title">com</span>)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="title">en</span>-<span class="type">US</span>) <span class="type">AppleWebKit</span>/532.5 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/4.0.249.0 <span class="type">Safari</span>/532.5",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 5.2; <span class="title">en</span>-<span class="type">US</span>) <span class="type">AppleWebKit</span>/532.9 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/5.0.310.0 <span class="type">Safari</span>/532.9",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 5.1; <span class="title">en</span>-<span class="type">US</span>) <span class="type">AppleWebKit</span>/534.7 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/7.0.514.0 <span class="type">Safari</span>/534.7",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.0; <span class="title">en</span>-<span class="type">US</span>) <span class="type">AppleWebKit</span>/534.14 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/9.0.601.0 <span class="type">Safari</span>/534.14",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="title">en</span>-<span class="type">US</span>) <span class="type">AppleWebKit</span>/534.14 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/10.0.601.0 <span class="type">Safari</span>/534.14",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="title">en</span>-<span class="type">US</span>) <span class="type">AppleWebKit</span>/534.20 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/11.0.672.2 <span class="type">Safari</span>/534.20",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">WOW64</span>) <span class="type">AppleWebKit</span>/534.27 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/12.0.712.0 <span class="type">Safari</span>/534.27",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">WOW64</span>) <span class="type">AppleWebKit</span>/535.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/13.0.782.24 <span class="type">Safari</span>/535.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.0) <span class="type">AppleWebKit</span>/535.2 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/15.0.874.120 <span class="type">Safari</span>/535.2",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">WOW64</span>) <span class="type">AppleWebKit</span>/535.7 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Chrome</span>/16.0.912.36 <span class="type">Safari</span>/535.7",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.0 <span class="title">x64</span>; <span class="title">en</span>-<span class="type">US</span>; <span class="title">rv</span>:1.9<span class="title">pre</span>) <span class="type">Gecko</span>/2008072421 <span class="type">Minefield</span>/3.0.2pre",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 5.1; <span class="title">en</span>-<span class="type">US</span>; <span class="title">rv</span>:1.9.0.10) <span class="type">Gecko</span>/2009042316 <span class="type">Firefox</span>/3.0.10",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.0; <span class="title">en</span>-<span class="type">GB</span>; <span class="title">rv</span>:1.9.0.11) <span class="type">Gecko</span>/2009060215 <span class="type">Firefox</span>/3.0.11 (.<span class="type">NET</span> <span class="type">CLR</span> 3.5.30729)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 6.0; <span class="title">en</span>-<span class="type">US</span>; <span class="title">rv</span>:1.9.1.6) <span class="type">Gecko</span>/20091201 <span class="type">Firefox</span>/3.5.6 <span class="type">GTB5</span>",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">NT</span> 5.1; <span class="title">tr</span>; <span class="title">rv</span>:1.9.2.8) <span class="type">Gecko</span>/20100722 <span class="type">Firefox</span>/3.6.8 ( .<span class="type">NET</span> <span class="type">CLR</span> 3.5.30729; .<span class="type">NET4</span>.0E)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="title">rv</span>:2.0.1) <span class="type">Gecko</span>/20100101 <span class="type">Firefox</span>/4.0.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">Win64</span>; <span class="title">x64</span>; <span class="title">rv</span>:2.0.1) <span class="type">Gecko</span>/20100101 <span class="type">Firefox</span>/4.0.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 5.1; <span class="title">rv</span>:5.0) <span class="type">Gecko</span>/20100101 <span class="type">Firefox</span>/5.0",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">WOW64</span>; <span class="title">rv</span>:6.0<span class="title">a2</span>) <span class="type">Gecko</span>/20110622 <span class="type">Firefox</span>/6.0a2",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">WOW64</span>; <span class="title">rv</span>:7.0.1) <span class="type">Gecko</span>/20100101 <span class="type">Firefox</span>/7.0.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span> <span class="type">NT</span> 6.1; <span class="type">WOW64</span>; <span class="title">rv</span>:2.0<span class="title">b4pre</span>) <span class="type">Gecko</span>/20100815 <span class="type">Minefield</span>/4.0b4pre",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/4.0 (<span class="title">compatible</span>; <span class="type">MSIE</span> 5.5; <span class="type">Windows</span> <span class="type">NT</span> 5.0 )",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/4.0 (<span class="title">compatible</span>; <span class="type">MSIE</span> 5.5; <span class="type">Windows</span> 98; <span class="type">Win</span> 9<span class="title">x</span> 4.90)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Windows</span> <span class="type">XP</span>) <span class="type">Gecko</span> <span class="type">MultiZilla</span>/1.6.1.0a",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/2.02E (<span class="type">Win95</span>; <span class="type">U</span>)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/3.01Gold (<span class="type">Win95</span>; <span class="type">I</span>)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/4.8 [en] (<span class="type">Windows</span> <span class="type">NT</span> 5.1; <span class="type">U</span>)",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Windows</span>; <span class="type">U</span>; <span class="type">Win98</span>; <span class="title">en</span>-<span class="type">US</span>; <span class="title">rv</span>:1.4) <span class="type">Gecko</span> <span class="type">Netscape</span>/7.1 (<span class="title">ax</span>)",</span></span><br><span class="line"><span class="class">	"<span class="type">HTC_Dream</span> <span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">en</span>-<span class="title">ca</span>; <span class="type">Build</span>/<span class="type">CUPCAKE</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="title">hp</span>-<span class="title">tablet</span>; <span class="type">Linux</span>; <span class="title">hpwOS</span>/3.0.2; <span class="type">U</span>; <span class="title">de</span>-<span class="type">DE</span>) <span class="type">AppleWebKit</span>/534.6 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) wOSBrowser/234.40.1 <span class="type">Safari</span>/534.6 <span class="type">TouchPad</span>/1.0",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">en</span>-<span class="title">us</span>; <span class="title">sdk</span> <span class="type">Build</span>/<span class="type">CUPCAKE</span>) <span class="type">AppleWebkit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.1; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Nexus</span> <span class="type">One</span> <span class="type">Build</span>/<span class="type">ERD62</span>) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Nexus</span> <span class="type">One</span> <span class="type">Build</span>/<span class="type">FRF91</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">en</span>-<span class="title">us</span>; <span class="title">htc_bahamas</span> <span class="type">Build</span>/<span class="type">CRB17</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.1-<span class="title">update1</span>; <span class="title">de</span>-<span class="title">de</span>; <span class="type">HTC</span> <span class="type">Desire</span> 1.19.161.5 <span class="type">Build</span>/<span class="type">ERE27</span>) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Sprint</span> <span class="type">APA9292KT</span> <span class="type">Build</span>/<span class="type">FRF91</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">de</span>-<span class="title">ch</span>; <span class="type">HTC</span> <span class="type">Hero</span> <span class="type">Build</span>/<span class="type">CUPCAKE</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">us</span>; <span class="type">ADR6300</span> <span class="type">Build</span>/<span class="type">FRF91</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.1; <span class="title">en</span>-<span class="title">us</span>; <span class="type">HTC</span> <span class="type">Legend</span> <span class="type">Build</span>/<span class="title">cupcake</span>) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">de</span>-<span class="title">de</span>; <span class="type">HTC</span> <span class="type">Magic</span> <span class="type">Build</span>/<span class="type">PLAT</span>-<span class="type">RC33</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1 <span class="type">FirePHP</span>/0.3",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.6; <span class="title">en</span>-<span class="title">us</span>; <span class="type">HTC_TATTOO_A3288</span> <span class="type">Build</span>/<span class="type">DRC79</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.0; <span class="title">en</span>-<span class="title">us</span>; <span class="title">dream</span>) <span class="type">AppleWebKit</span>/525.10  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.0.4 <span class="type">Mobile</span> <span class="type">Safari</span>/523.12.2",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">en</span>-<span class="title">us</span>; <span class="type">T</span>-<span class="type">Mobile</span> <span class="type">G1</span> <span class="type">Build</span>/<span class="type">CRB43</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span> 525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.5; <span class="title">en</span>-<span class="title">gb</span>; <span class="type">T</span>-<span class="type">Mobile_G2_Touch</span> <span class="type">Build</span>/<span class="type">CUPCAKE</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.0; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Droid</span> <span class="type">Build</span>/<span class="type">ESD20</span>) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Droid</span> <span class="type">Build</span>/<span class="type">FRG22D</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.0; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Milestone</span> <span class="type">Build</span>/ <span class="type">SHOLS_U2_01</span>.03.1) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.0.1; <span class="title">de</span>-<span class="title">de</span>; <span class="type">Milestone</span> <span class="type">Build</span>/<span class="type">SHOLS_U2_01</span>.14.0) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 3.0; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Xoom</span> <span class="type">Build</span>/<span class="type">HRI39</span>) <span class="type">AppleWebKit</span>/525.10  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.0.4 <span class="type">Mobile</span> <span class="type">Safari</span>/523.12.2",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 0.5; <span class="title">en</span>-<span class="title">us</span>) <span class="type">AppleWebKit</span>/522  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Safari</span>/419.3",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.1; <span class="title">en</span>-<span class="title">gb</span>; <span class="title">dream</span>) <span class="type">AppleWebKit</span>/525.10  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.0.4 <span class="type">Mobile</span> <span class="type">Safari</span>/523.12.2",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.0; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Droid</span> <span class="type">Build</span>/<span class="type">ESD20</span>) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.1; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Nexus</span> <span class="type">One</span> <span class="type">Build</span>/<span class="type">ERD62</span>) <span class="type">AppleWebKit</span>/530.17 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/530.17",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Sprint</span> <span class="type">APA9292KT</span> <span class="type">Build</span>/<span class="type">FRF91</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">us</span>; <span class="type">ADR6300</span> <span class="type">Build</span>/<span class="type">FRF91</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 2.2; <span class="title">en</span>-<span class="title">ca</span>; <span class="type">GT</span>-<span class="type">P1000M</span> <span class="type">Build</span>/<span class="type">FROYO</span>) <span class="type">AppleWebKit</span>/533.1 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Mobile</span> <span class="type">Safari</span>/533.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 3.0.1; <span class="title">fr</span>-<span class="title">fr</span>; <span class="type">A500</span> <span class="type">Build</span>/<span class="type">HRI66</span>) <span class="type">AppleWebKit</span>/534.13 (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/4.0 <span class="type">Safari</span>/534.13",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 3.0; <span class="title">en</span>-<span class="title">us</span>; <span class="type">Xoom</span> <span class="type">Build</span>/<span class="type">HRI39</span>) <span class="type">AppleWebKit</span>/525.10  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.0.4 <span class="type">Mobile</span> <span class="type">Safari</span>/523.12.2",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.6; <span class="title">es</span>-<span class="title">es</span>; <span class="type">SonyEricssonX10i</span> <span class="type">Build</span>/<span class="type">R1FA016</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">	"<span class="type">Mozilla</span>/5.0 (<span class="type">Linux</span>; <span class="type">U</span>; <span class="type">Android</span> 1.6; <span class="title">en</span>-<span class="title">us</span>; <span class="type">SonyEricssonX10i</span> <span class="type">Build</span>/<span class="type">R1AA056</span>) <span class="type">AppleWebKit</span>/528.5  (<span class="type">KHTML</span>, <span class="title">like</span> <span class="type">Gecko</span>) <span class="type">Version</span>/3.1.2 <span class="type">Mobile</span> <span class="type">Safari</span>/525.20.1",</span></span><br><span class="line"><span class="class">]</span></span><br></pre></td></tr></table></figure>
<p> 在settings.py添加设置</p>
 <figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DOWNLOADER_MIDDLEWARES = &#123;</span><br><span class="line">	<span class="string">'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware'</span><span class="symbol">:None</span>,</span><br><span class="line">	<span class="string">'LianjiaSpider.useragent_middleware.RotateUserAgentMiddleware'</span><span class="symbol">:</span><span class="number">100</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 其中LianjiaSPider是项目名字;useragent_middleware是UA中间件的文件名字;RotateUserAgentMiddleware是文件中的类</p>
</li>
<li><p>设置proxy池，随机分配ip<br> 因为要设置代理ip，这里可以用<a href="http://www.xicidaili.com/" target="_blank" rel="noopener">西刺</a>免费的代理ip，尽量选择存活时间长的，速度快的节点。<br> 在settings.py的同级目录下建立一个新的ip池中间件，文件名为proxy_middleware.py，代码如下:</p>
 <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line">import random</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyMiddleware</span>(<span class="title">object</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, ip=<span class="string">''</span>)</span></span><span class="symbol">:</span></span><br><span class="line">	    <span class="keyword">self</span>.ip = ip</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">process_request</span><span class="params">(<span class="keyword">self</span>, request, spider)</span></span><span class="symbol">:</span></span><br><span class="line">	    ip = random.choice(<span class="keyword">self</span>.ip_list)</span><br><span class="line">	    print(ip)</span><br><span class="line">	    request.meta[<span class="string">'proxy'</span>] = ip</span><br><span class="line"></span><br><span class="line">	ip_list =[</span><br><span class="line">           <span class="string">'https://218.29.111.106:9999'</span>,</span><br><span class="line">           <span class="string">'https://119.23.129.24:3128'</span>,]</span><br></pre></td></tr></table></figure>
<p> 在sttings.py中添加设置</p>
 <figure class="highlight roboconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DOWNLOADER_MIDDLEWARES = &#123;</span><br><span class="line">	'<span class="attribute">scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware'</span>: 110,</span><br><span class="line">	'LianjiaSpider<span class="variable">.proxy_middleware</span><span class="variable">.ProxyMiddleware</span>': 100,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 注意：<br> 如果要爬取目标的URL为http，那么代理ip选择http协议的，否则，代理ip选择https协议的。</p>
</li>
</ol>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>通过本次scrapy的学习，了解到了scrapy 运行机制。简述此过程Scheduler用于存储URL，它将URL传递给Downloader，Downloader请求URL，并将响应传递给Spiders，Spiders有两个主要作用1.对信息进行采集，并传递给Item Pipelines去处理 2.将下一次要请求的URL加入到Scheduler中。附上一张图，供学习使用:<br><img src="/images/scrapy3.png" alt=""><br>有时候用scrapy爬取的数据过多，导致ip被封禁，所以我们要对爬虫的属性进行配置，也就是说编辑settings.py文件，此外还可以设置ip池，和动态分配UA来反反爬虫。<br>更多的scrapy使用技巧会在之后学以致用。</p>

    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>The One</h4>
    <p>your life. your learning. your way.</p>
    
    <div class="author-meta">
      <span class="author-location icon-location">Earth</span>
      <span class="author-link icon-link"><a href="https://zjhdota.github.io">https://zjhdota.github.io</a></span>
    
      <section>
        
          <a href="https://github.com/zjhdota" class="author-social">github</a>
        
      </section>
    </div>
</section>

      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://yoursite.com/2017/07/11/scrapy-爬取链家网租房信息/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2017/07/11/scrapy-爬取链家网租房信息/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://yoursite.com/2017/07/11/scrapy-爬取链家网租房信息/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>
    </footer>
  </article>
  <nav class="pagination" role="pagination">
  
  <a class="newer-posts" href="/2018/02/14/分布式部署Pyspider/" title="分布式部署PySpider">
    ← Newer Post
  </a>
  
  <span class="page-number">•</span>
  
  <a class="older-posts" href="/2017/07/07/获取支付宝订单，并存储的数据库/" title="Python爬虫模拟登录支付宝并获取订单信息">
      Older Post →
  </a>
  
</nav>

  
</div>

</main>


  <footer class="site-footer clearfix">
 <section class="copyright"><a href="/">Nameless</a> &copy; 2015 &bull; All rights reserved.</section>
 <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/"> Hexo</a></section>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/jquery-2.0.3.min.js"><\/script>')</script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript">
(function($){
  var $postContent = $(".post-content");
  $postContent.fitVids();
})(jQuery);
</script>

<script type="text/javascript" src="/js/index.js"></script>

<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    var wrapAll = function(q) {
      $(q).each( function() {
        var $img = $(this),
            href = $img.attr('src');
        $img.wrap('<a rel="fancybox" href="' + href + '" title="' + $img.attr('alt') + '" class="link"></a>');
      });
    };
    wrapAll('.post-content img');
    wrapAll('.post-excerpt img');
    $('[rel="fancybox"]').fancybox();
  })(jQuery);
</script>





</body>
</html>
